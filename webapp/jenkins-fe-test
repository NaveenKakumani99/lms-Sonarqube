pipeline {
    agent {
      label 'lms-slave'
    }

    environment {

    DOCKERHUB_CREDENTIALS = credentials('docker credentials')
     registry = "yoursureshdockerhub/lms"
        registryCredential = 'docker credentials'
        dockerImage = ''
    }

    stages {
        


        stage('Building frontend image') {
            steps {
                sh 'cd webapp && docker build -t yoursureshdockerhub/lms .'
            }
        }








        stage('docker-login') {
            steps {
                sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
            }
        }

        stage('pushing image to dockerhub') {
            steps {
                  sh 'docker push yoursureshdockerhub/lms'
            }
        }



         stage('Running container') {
            steps {
                  sh 'docker container rm --force f-end'
                  sh 'docker run -dt -p 80:80 --name f-end yoursureshdockerhub/lms'
            }
        }
    }
}
